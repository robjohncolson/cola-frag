<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfume Formula Creator & Modifier</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .lucide {
            width: 16px;
            height: 16px;
            stroke-width: 2;
            stroke: currentColor;
            fill: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // Simple Lucide icons as SVG components
        const Download = () => (
            <svg className="lucide" viewBox="0 0 24 24">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7,10 12,15 17,10"/>
                <line x1="12" x2="12" y1="15" y2="3"/>
            </svg>
        );

        const Upload = () => (
            <svg className="lucide" viewBox="0 0 24 24">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-15"/>
                <polyline points="17,6 12,1 7,6"/>
                <line x1="12" x2="12" y1="1" y2="13"/>
            </svg>
        );

        const Plus = () => (
            <svg className="lucide" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" x2="12" y1="8" y2="16"/>
                <line x1="8" x2="16" y1="12" y2="12"/>
            </svg>
        );

        const Trash2 = () => (
            <svg className="lucide" viewBox="0 0 24 24">
                <polyline points="3,6 5,6 21,6"/>
                <path d="m19,6v14c0,1-1,2-2,2H7c-1,0-2-1-2-2V6m3,0V4c0-1,1-2,2-2h4c1,0,2,1,2,2v2"/>
                <line x1="10" x2="10" y1="11" y2="17"/>
                <line x1="14" x2="14" y1="11" y2="17"/>
            </svg>
        );

        const RotateCcw = () => (
            <svg className="lucide" viewBox="0 0 24 24">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
            </svg>
        );

        const Calculator = () => (
            <svg className="lucide" viewBox="0 0 24 24">
                <rect width="16" height="20" x="4" y="2" rx="2"/>
                <line x1="8" x2="16" y1="6" y2="6"/>
                <line x1="16" x2="16" y1="14" y2="18"/>
                <path d="m16 10 4 4-4 4"/>
                <path d="M12 14h4"/>
                <circle cx="8" cy="10" r="2"/>
                <path d="M8 12v4"/>
            </svg>
        );

        const FileText = () => (
            <svg className="lucide" viewBox="0 0 24 24">
                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
            </svg>
        );

        const PerfumeFormulaCreator = () => {
            // Initial formula based on the Aventus template
            const [ingredients, setIngredients] = useState([
                // Core Synthetics
                { id: 1, name: 'Hedione', category: 'Core Synthetic', dilution: 100, amount: 76.7, notes: 'Heart/floral radiance' },
                { id: 2, name: 'Iso E Super', category: 'Core Synthetic', dilution: 100, amount: 46.7, notes: 'Woody backbone' },
                { id: 3, name: 'Helvetolide', category: 'Core Synthetic', dilution: 100, amount: 46.7, notes: 'Musk base' },
                { id: 4, name: 'Ambroxan', category: 'Core Synthetic', dilution: 10, amount: 333.0, notes: 'Ambergris note' },
                { id: 5, name: 'Lyral', category: 'Core Synthetic', dilution: 100, amount: 11.0, notes: 'Floral lily' },
                { id: 6, name: 'Galaxolide', category: 'Core Synthetic', dilution: 27, amount: 29.0, notes: 'Musk substitute' },
                { id: 7, name: 'Coranol', category: 'Core Synthetic', dilution: 100, amount: 5.0, notes: 'Green/metallic' },
                { id: 8, name: 'Octyl Salicylate', category: 'Core Synthetic', dilution: 100, amount: 3.3, notes: 'UV filter' },
                { id: 9, name: 'Veramoss', category: 'Core Synthetic', dilution: 23, amount: 7.4, notes: 'Oakmoss alternative' },
                { id: 10, name: '2-Isobutyl Quinoline', category: 'Core Synthetic', dilution: 10, amount: 2.0, notes: 'Leather/animalic' },
                { id: 11, name: 'Damascone Alpha', category: 'Core Synthetic', dilution: 10, amount: 1.0, notes: 'Rose/fruity' },
                
                // Natural Oils
                { id: 12, name: 'Bergamot EO', category: 'Natural Oil', dilution: 100, amount: 33.3, notes: 'Citrus opening' },
                { id: 13, name: 'Patchouli EO', category: 'Natural Oil', dilution: 100, amount: 13.0, notes: 'Earthy/woody' },
                { id: 14, name: 'Patchoulol', category: 'Natural Oil', dilution: 27, amount: 12.0, notes: 'Smooth patchouli' },
                { id: 15, name: 'Petitgrain Bigarade', category: 'Natural Oil', dilution: 100, amount: 5.0, notes: 'Bitter orange leaves' },
                { id: 16, name: 'Pink Pepper EO', category: 'Natural Oil', dilution: 100, amount: 2.7, notes: 'Spicy/rosy' },
                { id: 17, name: 'Neroli EO', category: 'Natural Oil', dilution: 100, amount: 1.0, notes: 'Orange blossom' },
                { id: 18, name: 'Black Currant Bud Abs', category: 'Natural Oil', dilution: 10, amount: 3.3, notes: 'Fruity/green' },
                { id: 19, name: 'Birch Tar Rectified', category: 'Natural Oil', dilution: 1, amount: 7.0, notes: 'Smoky/leather' },
                
                // Opening Modifiers
                { id: 20, name: 'Linalyl Acetate', category: 'Opening Modifier', dilution: 100, amount: 12.0, notes: 'Lavender/bergamot' },
                { id: 21, name: 'Linalool', category: 'Opening Modifier', dilution: 100, amount: 5.0, notes: 'Floral/citrus' },
                { id: 22, name: 'Violet Leaf Absolute', category: 'Opening Modifier', dilution: 10, amount: 18.0, notes: 'Green/metallic' },
                { id: 23, name: 'Beta Pinene', category: 'Opening Modifier', dilution: 100, amount: 1.7, notes: 'Pineapple component' },
            ]);

            const [targetVolume, setTargetVolume] = useState(750);
            const [scaleFactor, setScaleFactor] = useState(1.0);

            // Calculate totals and statistics
            const stats = useMemo(() => {
                const totalRawVolume = ingredients.reduce((sum, ing) => sum + (ing.amount * scaleFactor), 0);
                const totalActiveVolume = ingredients.reduce((sum, ing) => 
                    sum + (ing.amount * scaleFactor * ing.dilution / 100), 0
                );
                const ethanolNeeded = Math.max(0, targetVolume - totalRawVolume);
                const fragranceConcentration = totalActiveVolume / targetVolume * 100;
                
                return {
                    totalRawVolume: totalRawVolume.toFixed(1),
                    totalActiveVolume: totalActiveVolume.toFixed(1),
                    ethanolNeeded: ethanolNeeded.toFixed(1),
                    fragranceConcentration: fragranceConcentration.toFixed(1),
                    totalVolume: targetVolume
                };
            }, [ingredients, targetVolume, scaleFactor]);

            // Group ingredients by category
            const groupedIngredients = useMemo(() => {
                return ingredients.reduce((groups, ingredient) => {
                    const category = ingredient.category;
                    if (!groups[category]) {
                        groups[category] = [];
                    }
                    groups[category].push(ingredient);
                    return groups;
                }, {});
            }, [ingredients]);

            // Update ingredient
            const updateIngredient = (id, field, value) => {
                setIngredients(prev => prev.map(ing => 
                    ing.id === id ? { ...ing, [field]: parseFloat(value) || 0 } : ing
                ));
            };

            // Add new ingredient
            const addIngredient = () => {
                const newId = Math.max(...ingredients.map(i => i.id)) + 1;
                setIngredients(prev => [...prev, {
                    id: newId,
                    name: 'New Ingredient',
                    category: 'Custom',
                    dilution: 100,
                    amount: 1.0,
                    notes: 'Custom addition'
                }]);
            };

            // Remove ingredient
            const removeIngredient = (id) => {
                setIngredients(prev => prev.filter(ing => ing.id !== id));
            };

            // Reset to original formula
            const resetFormula = () => {
                window.location.reload();
            };

            // Import formula
            const importFormula = () => {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json,.csv,.txt';
                input.onchange = (event) => {
                    const file = event.target.files[0];
                    if (!file) return;

                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const content = e.target.result;
                            let data;

                            if (file.name.endsWith('.json')) {
                                data = JSON.parse(content);
                                if (data.ingredients) {
                                    setIngredients(data.ingredients.map(ing => ({
                                        ...ing,
                                        id: ing.id || Math.random() * 10000,
                                        amount: parseFloat(ing.amount) || parseFloat(ing.scaledAmount) || 0,
                                        dilution: parseFloat(ing.dilution) || 100,
                                        category: ing.category || 'Custom',
                                        notes: ing.notes || ''
                                    })));
                                    if (data.targetVolume) setTargetVolume(data.targetVolume);
                                    if (data.scaleFactor) setScaleFactor(data.scaleFactor);
                                }
                            } else if (file.name.endsWith('.csv')) {
                                // Parse CSV format
                                const lines = content.split('\n').filter(line => line.trim());
                                const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
                                
                                const nameIndex = headers.findIndex(h => h.includes('name') || h.includes('ingredient'));
                                const amountIndex = headers.findIndex(h => h.includes('amount') || h.includes('quantity'));
                                const dilutionIndex = headers.findIndex(h => h.includes('dilution') || h.includes('concentration'));
                                const categoryIndex = headers.findIndex(h => h.includes('category') || h.includes('type'));
                                const notesIndex = headers.findIndex(h => h.includes('notes') || h.includes('description'));

                                if (nameIndex === -1 || amountIndex === -1) {
                                    throw new Error('CSV must contain at least "name" and "amount" columns');
                                }

                                const importedIngredients = lines.slice(1).map((line, index) => {
                                    const cols = line.split(',').map(c => c.trim());
                                    return {
                                        id: Date.now() + index,
                                        name: cols[nameIndex] || `Ingredient ${index + 1}`,
                                        amount: parseFloat(cols[amountIndex]) || 1.0,
                                        dilution: dilutionIndex >= 0 ? parseFloat(cols[dilutionIndex]) || 100 : 100,
                                        category: categoryIndex >= 0 ? cols[categoryIndex] || 'Imported' : 'Imported',
                                        notes: notesIndex >= 0 ? cols[notesIndex] || '' : ''
                                    };
                                });

                                setIngredients(importedIngredients);
                            } else {
                                // Try to parse as plain text with basic structure
                                const lines = content.split('\n').filter(line => line.trim());
                                const importedIngredients = lines.map((line, index) => {
                                    const parts = line.split(/[\t,]/);
                                    return {
                                        id: Date.now() + index,
                                        name: parts[0]?.trim() || `Ingredient ${index + 1}`,
                                        amount: parseFloat(parts[1]) || 1.0,
                                        dilution: parseFloat(parts[2]) || 100,
                                        category: parts[3]?.trim() || 'Imported',
                                        notes: parts[4]?.trim() || ''
                                    };
                                });
                                setIngredients(importedIngredients);
                            }

                            alert('Formula imported successfully!');
                        } catch (error) {
                            alert(`Import failed: ${error.message}`);
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            };

            // Export formula
            const exportFormula = () => {
                const formulaData = {
                    exportDate: new Date().toISOString(),
                    targetVolume,
                    scaleFactor,
                    ingredients: ingredients.map(ing => ({
                        ...ing,
                        scaledAmount: (ing.amount * scaleFactor).toFixed(2),
                        activeAmount: (ing.amount * scaleFactor * ing.dilution / 100).toFixed(2),
                        activeRatio: ((ing.amount * scaleFactor * ing.dilution / 100) / parseFloat(stats.totalActiveVolume) * 100).toFixed(2) + '%'
                    })),
                    stats,
                    formulation: {
                        totalIngredients: ingredients.length,
                        strengthCategory: getStrengthCategory(parseFloat(stats.fragranceConcentration)).name
                    }
                };
                
                const dataStr = JSON.stringify(formulaData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `perfume_formula_${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
            };

                                    // Export as CSV
            const exportCSV = () => {
                const headers = ['Name', 'Category', 'Dilution %', 'Base Amount μL', 'Scaled Amount μL', 'Active Amount μL', 'Active Ratio %', 'Notes'];
                const rows = ingredients.map(ing => [
                    ing.name,
                    ing.category,
                    ing.dilution,
                    ing.amount.toFixed(2),
                    (ing.amount * scaleFactor).toFixed(2),
                    (ing.amount * scaleFactor * ing.dilution / 100).toFixed(2),
                    ((ing.amount * scaleFactor * ing.dilution / 100) / parseFloat(stats.totalActiveVolume) * 100).toFixed(2) + '%',
                    ing.notes
                ]);

                const csvContent = [headers, ...rows].map(row => 
                    row.map(cell => `"${cell}"`).join(',')
                ).join('\n');

                const dataBlob = new Blob([csvContent], {type: 'text/csv'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `perfume_formula_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
                URL.revokeObjectURL(url);
            };

            const getStrengthCategory = (concentration) => {
                if (concentration < 5) return { name: 'Eau Fraiche', color: 'text-blue-600' };
                if (concentration < 15) return { name: 'Eau de Cologne', color: 'text-green-600' };
                if (concentration < 20) return { name: 'Eau de Toilette', color: 'text-yellow-600' };
                if (concentration < 30) return { name: 'Eau de Parfum', color: 'text-orange-600' };
                return { name: 'Parfum/Extrait', color: 'text-red-600' };
            };

            const strengthCategory = getStrengthCategory(parseFloat(stats.fragranceConcentration));

            return (
                <div className="max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen">
                    <div className="bg-white rounded-lg shadow-lg p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h1 className="text-3xl font-bold text-gray-800">Perfume Formula Creator</h1>
                            <div className="flex gap-2 flex-wrap">
                                <button
                                    onClick={importFormula}
                                    className="flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors"
                                >
                                    <Upload />
                                    Import
                                </button>
                                <button
                                    onClick={addIngredient}
                                    className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                >
                                    <Plus />
                                    Add Ingredient
                                </button>
                                <button
                                    onClick={resetFormula}
                                    className="flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
                                >
                                    <RotateCcw />
                                    Reset
                                </button>
                                <div className="relative">
                                    <button
                                        onClick={exportFormula}
                                        className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
                                    >
                                        <Download />
                                        Export JSON
                                    </button>
                                </div>
                                <button
                                    onClick={exportCSV}
                                    className="flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors"
                                >
                                    <FileText />
                                    Export CSV
                                </button>
                            </div>
                        </div>

                        {/* Import Instructions */}
                        <div className="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <h3 className="font-semibold text-blue-800 mb-2">Import Instructions</h3>
                            <div className="text-sm text-blue-700 space-y-1">
                                <p><strong>JSON:</strong> Export files from this app, or any JSON with "ingredients" array containing name, amount, dilution, category, notes</p>
                                <p><strong>CSV:</strong> Columns: Name, Amount, Dilution (optional), Category (optional), Notes (optional)</p>
                                <p><strong>TXT:</strong> Tab or comma-separated: Name, Amount, Dilution, Category, Notes</p>
                            </div>
                        </div>

                        {/* Controls */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 p-4 bg-gray-100 rounded-lg">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Target Volume (μL)</label>
                                <input
                                    type="number"
                                    value={targetVolume}
                                    onChange={(e) => setTargetVolume(parseFloat(e.target.value) || 750)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Scale Factor</label>
                                <input
                                    type="number"
                                    step="0.1"
                                    value={scaleFactor}
                                    onChange={(e) => setScaleFactor(parseFloat(e.target.value) || 1.0)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Fragrance Strength</label>
                                <div className={`px-3 py-2 rounded-md bg-white border ${strengthCategory.color} font-semibold`}>
                                    {strengthCategory.name}
                                </div>
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">Concentration</label>
                                <div className="px-3 py-2 rounded-md bg-white border font-semibold">
                                    {stats.fragranceConcentration}%
                                </div>
                            </div>
                        </div>

                        {/* Statistics Panel */}
                        <div className="grid grid-cols-2 lg:grid-cols-6 gap-4 mb-6 p-4 bg-blue-50 rounded-lg">
                            <div className="text-center">
                                <div className="text-sm text-gray-600">Raw Volume</div>
                                <div className="text-lg font-bold text-blue-600">{stats.totalRawVolume} μL</div>
                            </div>
                            <div className="text-center">
                                <div className="text-sm text-gray-600">Active Volume</div>
                                <div className="text-lg font-bold text-green-600">{stats.totalActiveVolume} μL</div>
                            </div>
                            <div className="text-center">
                                <div className="text-sm text-gray-600">Ethanol Needed</div>
                                <div className="text-lg font-bold text-purple-600">{stats.ethanolNeeded} μL</div>
                            </div>
                            <div className="text-center">
                                <div className="text-sm text-gray-600">Total Volume</div>
                                <div className="text-lg font-bold text-gray-600">{stats.totalVolume} μL</div>
                            </div>
                            <div className="text-center">
                                <div className="text-sm text-gray-600">Ingredient Count</div>
                                <div className="text-lg font-bold text-orange-600">{ingredients.length}</div>
                            </div>
                            <div className="text-center">
                                <div className="text-sm text-gray-600">Top Ingredient</div>
                                <div className="text-xs font-bold text-indigo-600">
                                    {ingredients.reduce((top, ing) => {
                                        const activeAmount = ing.amount * scaleFactor * ing.dilution / 100;
                                        const topAmount = top.amount * scaleFactor * top.dilution / 100;
                                        return activeAmount > topAmount ? ing : top;
                                    }, ingredients[0])?.name.substring(0, 12) || 'None'}
                                </div>
                            </div>
                        </div>

                        {/* Ingredients Table */}
                        <div className="space-y-6">
                            {Object.entries(groupedIngredients).map(([category, categoryIngredients]) => (
                                <div key={category} className="border border-gray-200 rounded-lg overflow-hidden">
                                    <div className="bg-gray-100 px-4 py-2">
                                        <h3 className="font-semibold text-gray-800">{category} ({categoryIngredients.length} ingredients)</h3>
                                    </div>
                                    <div className="overflow-x-auto">
                                        <table className="w-full">
                                            <thead className="bg-gray-50">
                                                <tr>
                                                    <th className="px-4 py-2 text-left text-sm font-medium text-gray-700">Ingredient</th>
                                                    <th className="px-4 py-2 text-left text-sm font-medium text-gray-700">Notes</th>
                                                    <th className="px-4 py-2 text-center text-sm font-medium text-gray-700">Dilution %</th>
                                                    <th className="px-4 py-2 text-center text-sm font-medium text-gray-700">Base Amount (μL)</th>
                                                    <th className="px-4 py-2 text-center text-sm font-medium text-gray-700">Scaled Amount (μL)</th>
                                                    <th className="px-4 py-2 text-center text-sm font-medium text-gray-700">Active Amount (μL)</th>
                                                    <th className="px-4 py-2 text-center text-sm font-medium text-gray-700">Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {categoryIngredients.map((ingredient) => (
                                                    <tr key={ingredient.id} className="border-t border-gray-200 hover:bg-gray-50">
                                                        <td className="px-4 py-2">
                                                            <input
                                                                type="text"
                                                                value={ingredient.name}
                                                                onChange={(e) => setIngredients(prev => prev.map(ing => 
                                                                    ing.id === ingredient.id ? { ...ing, name: e.target.value } : ing
                                                                ))}
                                                                className="w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"
                                                            />
                                                        </td>
                                                        <td className="px-4 py-2">
                                                            <input
                                                                type="text"
                                                                value={ingredient.notes}
                                                                onChange={(e) => setIngredients(prev => prev.map(ing => 
                                                                    ing.id === ingredient.id ? { ...ing, notes: e.target.value } : ing
                                                                ))}
                                                                className="w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"
                                                            />
                                                        </td>
                                                        <td className="px-4 py-2">
                                                            <input
                                                                type="number"
                                                                step="0.1"
                                                                value={ingredient.dilution}
                                                                onChange={(e) => updateIngredient(ingredient.id, 'dilution', e.target.value)}
                                                                className="w-16 px-2 py-1 border border-gray-300 rounded text-sm text-center focus:outline-none focus:ring-1 focus:ring-blue-500"
                                                            />
                                                        </td>
                                                        <td className="px-4 py-2">
                                                            <input
                                                                type="number"
                                                                step="0.1"
                                                                value={ingredient.amount}
                                                                onChange={(e) => updateIngredient(ingredient.id, 'amount', e.target.value)}
                                                                className="w-20 px-2 py-1 border border-gray-300 rounded text-sm text-center focus:outline-none focus:ring-1 focus:ring-blue-500"
                                                            />
                                                        </td>
                                                        <td className="px-4 py-2 text-center text-sm font-medium text-blue-600">
                                                            {(ingredient.amount * scaleFactor).toFixed(1)}
                                                        </td>
                                                        <td className="px-4 py-2 text-center text-sm font-medium text-green-600">
                                                            {(ingredient.amount * scaleFactor * ingredient.dilution / 100).toFixed(1)}
                                                        </td>
                                                        <td className="px-4 py-2 text-center text-sm font-medium text-purple-600">
                                                            {((ingredient.amount * scaleFactor * ingredient.dilution / 100) / parseFloat(stats.totalActiveVolume) * 100).toFixed(1)}%
                                                        </td>
                                                        <td className="px-4 py-2 text-center">
                                                            <button
                                                                onClick={() => removeIngredient(ingredient.id)}
                                                                className="text-red-600 hover:text-red-800 transition-colors"
                                                            >
                                                                <Trash2 />
                                                            </button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {/* Final Formula Summary */}
                        <div className="mt-6 p-4 bg-green-50 rounded-lg border border-green-200">
                            <h3 className="font-semibold text-green-800 mb-2 flex items-center gap-2">
                                <Calculator />
                                Final Formula Summary
                            </h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                <div>
                                    <p><strong>Total Ingredients Volume:</strong> {stats.totalRawVolume} μL</p>
                                    <p><strong>Active Fragrance Oil:</strong> {stats.totalActiveVolume} μL</p>
                                    <p><strong>Ethanol (95%) Required:</strong> {stats.ethanolNeeded} μL</p>
                                </div>
                                <div>
                                    <p><strong>Final Volume:</strong> {stats.totalVolume} μL</p>
                                    <p><strong>Fragrance Concentration:</strong> {stats.fragranceConcentration}%</p>
                                    <p><strong>Strength Category:</strong> <span className={strengthCategory.color}>{strengthCategory.name}</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<PerfumeFormulaCreator />, document.getElementById('root'));
    </script>
</body>
</html>